!function(e){e(window).on("load",function(){e("html").addClass("colorpicker-ready")}),wp.customize.controlConstructor["colormag-background"]=wp.customize.Control.extend({ready:function(){"use strict";this.initColorMagBackgroundControl()},initColorMagBackgroundControl:function(){var a=this,e=a.setting._value,t=a.container.find(".colormag-color-picker-alpha");!_.isUndefined(e["background-image"])&&""!==e["background-image"]||(a.container.find(".customize-control-content > .background-repeat").hide(),a.container.find(".customize-control-content > .background-position").hide(),a.container.find(".customize-control-content > .background-size").hide(),a.container.find(".customize-control-content > .background-attachment").hide()),t.wpColorPicker({change:function(){jQuery("html").hasClass("colorpicker-ready")&&setTimeout(function(){a.saveValue("background-color",t.val())},100)},clear:function(e){jQuery(e.target).closest(".wp-picker-input-wrap").find(".wp-color-picker")[0]&&a.saveValue("background-color","")}}),a.container.on("click",".background-image-upload-button",function(e){var r=wp.media({multiple:!1}).open().on("select",function(){var e,t,n,o=r.state().get("selection").first(),i=o.toJSON().sizes.full.url;_.isUndefined(o.toJSON().sizes.medium)?_.isUndefined(o.toJSON().sizes.thumbnail)||(i=o.toJSON().sizes.thumbnail.url):i=o.toJSON().sizes.medium.url,e=o.toJSON().sizes.full.url,o.toJSON().id,o.toJSON().width,o.toJSON().height,""!==e&&a.container.find(".customize-control-content > .background-repeat, .customize-control-content > .background-position, .customize-control-content > .background-size, .customize-control-content > .background-attachment").show(),a.saveValue("background-image",e),t=a.container.find(".placeholder, .thumbnail"),n=a.container.find(".background-image-upload-remove-button"),t.length&&t.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+i+'" alt="" />'),n.length&&n.show()});e.preventDefault()}),a.container.on("click",".background-image-upload-remove-button",function(e){var t,n;e.preventDefault(),a.saveValue("background-image",""),t=a.container.find(".placeholder, .thumbnail"),n=a.container.find(".background-image-upload-remove-button"),a.container.find(".customize-control-content > .background-repeat").hide(),a.container.find(".customize-control-content > .background-position").hide(),a.container.find(".customize-control-content > .background-size").hide(),a.container.find(".customize-control-content > .background-attachment").hide(),t.length&&t.removeClass().addClass("placeholder").html(ColorMagCustomizerControlBackground.placeholder),n.length&&n.hide()}),a.container.on("change",".background-repeat select",function(){a.saveValue("background-repeat",jQuery(this).val())}),a.container.on("change",".background-position select",function(){a.saveValue("background-position",jQuery(this).val())}),a.container.on("change",".background-size select",function(){a.saveValue("background-size",jQuery(this).val())}),a.container.on("change",".background-attachment select",function(){a.saveValue("background-attachment",jQuery(this).val())})},saveValue:function(e,t){var n=this,o=jQuery("#customize-control-"+n.id.replace("[","-").replace("]","")+" .background-hidden-value"),i=n.setting._value;i[e]=t,jQuery(o).attr("value",JSON.stringify(i)).trigger("change"),n.setting.set(i)}})}(jQuery),wp.customize.controlConstructor["colormag-buttonset"]=wp.customize.Control.extend({ready:function(){"use strict";var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),function(e){e(window).on("load",function(){e("html").addClass("colorpicker-ready")}),wp.customize.controlConstructor["colormag-color"]=wp.customize.Control.extend({ready:function(){"use strict";var o=this;this.container.find(".colormag-color-picker-alpha").wpColorPicker({change:function(e,t){var n=t.color.toString();jQuery("html").hasClass("colorpicker-ready")&&o.setting.set(n)}})}})}(jQuery),wp.customize.controlConstructor["colormag-dropdown-categories"]=wp.customize.Control.extend({ready:function(){"use strict";var e=this;this.container.on("change","select",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["colormag-editor"]=wp.customize.Control.extend({ready:function(){"use strict";var e="editor_"+this.id;wp.editor.initialize(e,{tinymce:{wpautop:!0},quicktags:!0,mediaButtons:!0})},onChangeActive:function(e,t){"use strict";var n,o=this,i="editor_"+o.id,r=o.container.find("textarea");(n=tinyMCE.get(i))&&n.onChange.add(function(e){var t;e.save(),t=n.getContent(),r.val(t).trigger("change"),wp.customize.instance(o.id).set(t)})}}),wp.customize.controlConstructor["colormag-radio-image"]=wp.customize.Control.extend({ready:function(){"use strict";var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["colormag-toggle"]=wp.customize.Control.extend({ready:function(){"use strict";var e=this,t=e.setting._value;this.container.on("change","input",function(){t=!!jQuery(this).is(":checked"),e.setting.set(t)})}}),wp.customize.controlConstructor["colormag-typography"]=wp.customize.Control.extend({ready:function(){"use strict";var e=this;e.renderFontSelector(),e.renderVariantSelector(),e.renderSubsetSelector(),e.container.on("change",".font-style select",function(){e.saveValue("font-style",jQuery(this).val())}),e.container.on("change",".text-transform select",function(){e.saveValue("text-transform",jQuery(this).val())})},renderFontSelector:function(){var e,t=this,n=t.selector+" .font-family select",o=[],i=[],r=[],a=t.setting._value,c=t.getFonts();_.isUndefined(c.standard)||_.each(c.standard,function(e){o.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),_.isUndefined(c.google)||_.each(c.google,function(e){i.push({id:e.family,text:e.label})}),data=[{text:c.standardfontslabel,children:o},{text:c.googlefontslabel,children:i}],_.isUndefined(c.custom)||(_.each(c.custom,function(e){r.push({id:e.family,text:e.label})}),data.push({text:c.customfontslabel,children:r})),e=jQuery(n).selectWoo({data:data,width:"100%"}),a["font-family"]&&e.val(a["font-family"].replace(/'/g,'"')).trigger("change"),e.on("change",function(){t.saveValue("font-family",jQuery(this).val()),t.renderVariantSelector(),t.renderSubsetSelector()})},getFonts:function(){return _.isUndefined(ColorMagCustomizerControlTypography)?{google:[],standard:[]}:ColorMagCustomizerControlTypography},renderVariantSelector:function(){var e,t=this,n=t.setting._value,o=n["font-family"],i=t.getVariants(o),r=t.selector+" .font-weight select",a=[],c=!1;!1!==i?(jQuery(t.selector+" .font-weight").show(),_.each(i,function(e){n["font-weight"]===e.id&&(c=!0),a.push({id:e.id,text:e.label})}),c||(n["font-weight"]="regular"),jQuery(r).hasClass("select2-hidden-accessible")&&(jQuery(r).selectWoo("destroy"),jQuery(r).empty()),(e=jQuery(r).selectWoo({data:a,width:"100%"})).val(n["font-weight"]).trigger("change"),e.on("change",function(){t.saveValue("font-weight",jQuery(this).val())})):jQuery(t.selector+" .font-weight").hide()},getVariants:function(t){var e=this.getFonts(),n=!1;return _.each(e.standard,function(e){if(t&&e.family===t.replace(/'/g,'"'))return n=e.variants}),_.each(e.google,function(e){if(e.family===t)return n=e.variants}),_.isUndefined(e.custom)||_.each(e.custom,function(e){if(e.custom===t)return n=e.variants}),n},renderSubsetSelector:function(){var e,t=this,n=t.setting._value,o=n["font-family"],i=t.getSubsets(o),r=t.selector+" .subsets select",a=[],c=n.subsets;!1!==i?(jQuery(t.selector+" .subsets").show(),_.each(i,function(t){_.isObject(c)&&-1===c.indexOf(t.id)&&(c=_.reject(c,function(e){return e===t.id})),a.push({id:t.id,text:t.label})})):jQuery(t.selector+" .subsets").hide(),jQuery(r).hasClass("select2-hidden-accessible")&&(jQuery(r).selectWoo("destroy"),jQuery(r).empty()),(e=jQuery(r).selectWoo({data:a})).val(c).trigger("change"),e.on("change",function(){t.saveValue("subsets",jQuery(this).val())})},getSubsets:function(t){var n=!1,e=this.getFonts();return _.each(e.google,function(e){if(e.family===t)return n=e.subsets}),n},saveValue:function(e,t){var n=this.container.find(".typography-hidden-value"),o=this.setting._value;o[e]=t,jQuery(n).attr("value",JSON.stringify(o)).trigger("change"),this.setting.set(o)}}),wp.customize.controlConstructor["colormag-slider"]=wp.customize.Control.extend({ready:function(){"use strict";var t=this;jQuery("input[type=range]").on("input change",function(){var e=jQuery(this).attr("value"),t=jQuery(this).closest(".slider-wrapper").find(".colormag-range-value .value");t.val(e),t.change()}),jQuery(".colormag-slider-reset").click(function(){var e=jQuery(this).closest(".slider-wrapper"),t=e.find("input[type=range]"),n=e.find(".colormag-range-value .value"),o=t.data("reset_value");t.val(o),n.val(o),n.change()}),this.container.on("input change","input[type=number]",function(){var e=jQuery(this).val();jQuery(this).closest(".slider-wrapper").find("input[type=range]").val(e),t.setting.set(e)})}});